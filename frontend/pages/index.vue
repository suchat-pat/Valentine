<template>
  <v-container fluid class="fill-height overflow-hidden position-relative pa-0 birthday-bg">
    
    <v-row justify="center" align="center" class="fill-height z-index-1">
      <v-col cols="12" sm="8" md="6" class="text-center">
        
        <v-card elevation="10" rounded="xl" class="pa-6 glass-card" v-if="revealedCount > 5">
          <v-icon color="pink-lighten-2" size="60" class="mb-4 animate-bounce">mdi-cake-variant</v-icon>
          
          <h1 class="text-h4 text-md-h3 font-weight-bold text-pink-darken-2 mb-4">
            Happy Birthday Day! üéÇ
          </h1>

          <v-carousel 
            cycle 
            height="auto" 
            hide-delimiter-background
            show-arrows="hover"
            class="rounded-lg mb-6 shadow-lg"
          >
            <v-carousel-item
              v-for="(slide, i) in slides"
              :key="i"
              :src="slide.src"
              cover
            >
            </v-carousel-item>
          </v-carousel>

          <p class="text-body-1 text-grey-darken-2 mb-6">
            ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏°‡∏≤‡∏Å‡πÜ‡∏ô‡∏∞ ‡∏°‡∏µ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏¢‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡πÅ‡∏Ç‡πá‡∏á‡πÑ‡∏°‡πà ‡∏°‡∏µ‡πÅ‡∏ï‡πà‡∏£‡∏≠‡∏¢‡∏¢‡∏¥‡πâ‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡∏∞‡∏ï‡∏•‡∏≠‡∏î‡∏õ‡∏µ‡∏ô‡∏µ‡πâ <br> ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏Å‡∏ô‡∏∞ <br>#‡∏£‡∏±‡∏Å‡πÅ‡∏ü‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‚ù§Ô∏è
          </p>

          <v-fade-transition>
            <v-btn
              v-if="progress >= 80"
              color="pink-accent-3"
              size="x-large"
              rounded="pill"
              elevation="6"
              @click="dialog = true"
              class="animate-pulse"
            >
              <v-icon start>mdi-gift-open</v-icon>
              ‡∏Å‡∏î‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç
            </v-btn>
          </v-fade-transition>
        </v-card>

        <div v-else class="text-white text-h5 font-weight-bold drop-shadow">
          <v-icon class="animate-shake" color="white" size="40">mdi-gesture-tap</v-icon>
          <br>
          ‡∏à‡∏¥‡πâ‡∏°‡∏•‡∏π‡∏Å‡πÇ‡∏õ‡πà‡∏á‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡∏Å‡∏™‡∏¥!
        </div>

      </v-col>
    </v-row>

    <div 
      v-for="(balloon, index) in balloons" 
      :key="index"
      class="balloon-wrapper"
      :style="{ 
        top: balloon.top + '%', 
        left: balloon.left + '%',
        animationDuration: balloon.speed + 's',
        zIndex: 2000 
      }"
    >
      <v-icon
        v-if="!balloon.popped"
        :color="balloon.color"
        :size="balloon.size"
        class="balloon-item"
        @click.stop="popBalloon(index)" 
      >
        mdi-balloon
      </v-icon>
      
      <v-icon
        v-if="balloon.popped && balloon.showPop"
        color="pink-accent-2"
        size="50"
        class="pop-effect"
      >
        mdi-star-four-points
      </v-icon>
    </div>

    <v-dialog v-model="dialog" width="auto">
      <v-card max-width="400" rounded="xl" class="pa-4 text-center">
        <v-card-text>
          <v-img 
            src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExajIxeGZ5NXF6eXJtY3J6Z3J6Z3J6Z3J6Z3J6Z3J6Z3J6Z3J6/L05M4y1e8gI43z4/giphy.gif" 
            height="200" 
            cover 
            class="rounded-lg mb-4"
          ></v-img>
          <h2 class="text-h5 text-pink font-weight-bold">üéÅ ‡∏ï‡∏±‡πã‡∏ß‡∏ï‡∏≤‡∏°‡πÉ‡∏à 1 ‡∏ß‡∏±‡∏ô! üéÅ</h2>
          <p class="mt-2 text-grey-darken-1">
            ‡∏ï‡∏≤‡∏°‡πÉ‡∏à‡πÅ‡∏ü‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏ï‡πá‡∏°‡πÜ ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞ ‡∏à‡∏∞‡πÑ‡∏õ‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á ‡∏î‡∏π‡∏´‡∏ô‡∏±‡∏á ‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß ‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏ó‡∏≥! <br>
            ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏°‡∏≤‡∏Å‡πÜ‡∏ô‡∏∞ ‡∏£‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏•‡∏¢ ‚ù§Ô∏è <br> (‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡πã‡∏ß‡∏ô‡∏µ‡πâ‡∏ô‡∏∞!)
          </p>
        </v-card-text>
        <v-card-actions class="justify-center">
          <v-btn color="pink" variant="flat" @click="dialog = false">‡πÅ‡∏ö‡∏£‡πà~~</v-btn>
        </v-card-actions>
      </v-card>
    </v-dialog>

    <v-btn
      icon
      color="white"
      variant="text"
      class="position-absolute top-0 right-0 ma-4 z-index-top"
      @click="toggleMusic"
    >
      <v-icon>{{ isPlaying ? 'mdi-music' : 'mdi-music-off' }}</v-icon>
    </v-btn>

  </v-container>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue'

// --- State ---
const dialog = ref(false)
const isPlaying = ref(false)
const revealedCount = ref(0) // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏π‡∏Å‡πÇ‡∏õ‡πà‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å
const balloons = ref([])

// --- ‡∏£‡∏π‡∏õ‡πÉ‡∏ô Carousel (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏£‡∏π‡∏õ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ) ---
const slides = [
  { src: 'img/11.jpg' }, // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏Ñ‡∏π‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
  { src: 'img/22.jpg' },
  { src: 'img/33.jpg' },
]

// --- Logic ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏π‡∏Å‡πÇ‡∏õ‡πà‡∏á ---
const colors = ['red-lighten-2', 'pink-lighten-3', 'purple-lighten-3', 'blue-lighten-3', 'teal-lighten-3', 'amber-lighten-3']

const initBalloons = () => {
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏π‡∏Å‡πÇ‡∏õ‡πà‡∏á 30 ‡∏•‡∏π‡∏Å ‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
  for (let i = 0; i < 30; i++) {
    balloons.value.push({
      top: Math.random() * 90,     // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á 0-90%
      left: Math.random() * 90,    // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô 0-90%
      size: Math.random() * 60 + 80, // ‡∏Ç‡∏ô‡∏≤‡∏î 80-140px
      color: colors[Math.floor(Math.random() * colors.length)],
      speed: Math.random() * 3 + 2, // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏•‡∏≠‡∏¢
      popped: false,
      showPop: false
    })
  }
}

// --- Logic ‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏π‡∏Å‡πÇ‡∏õ‡πà‡∏á ---
const popBalloon = (index) => {
  if (balloons.value[index].popped) return
  
  // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡∏Å
  balloons.value[index].popped = true
  balloons.value[index].showPop = true
  revealedCount.value++

  // ‡∏ã‡πà‡∏≠‡∏ô effect ‡πÅ‡∏ï‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å 0.5 ‡∏ß‡∏¥
  setTimeout(() => {
    balloons.value[index].showPop = false
  }, 500)
}

// ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì % ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤
const progress = computed(() => {
  return (revealedCount.value / balloons.value.length) * 100
})

// --- ‡πÄ‡∏û‡∏•‡∏á (Optional) ---
// Browser ‡∏™‡∏°‡∏±‡∏¢‡πÉ‡∏´‡∏°‡πà‡∏´‡πâ‡∏≤‡∏° Auto-play ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ user ‡∏Å‡∏î‡∏Å‡πà‡∏≠‡∏ô
const toggleMusic = () => {
  isPlaying.value = !isPlaying.value
  // ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏™‡πà new Audio('file.mp3').play() ‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏û‡∏•‡∏á
}

onMounted(() => {
  initBalloons()
})
</script>

<style scoped>
/* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á Gradient ‡∏´‡∏ß‡∏≤‡∏ô‡πÜ */
.birthday-bg {
  background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
  /* ‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡πâ‡∏≤‡∏ä‡∏≠‡∏ö‡∏™‡∏µ‡∏™‡∏±‡∏ô: background: linear-gradient(120deg, #a1c4fd 0%, #c2e9fb 100%); */
  background: radial-gradient(circle at center, #ffe6fa, #e3f2fd);
}

.z-index-1 { z-index: 1; }
.z-index-top { z-index: 100; }

/* ‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏∞‡∏à‡∏Å‡∏ù‡πâ‡∏≤ */
.glass-card {
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.5);
}

/* Animation ‡∏•‡∏π‡∏Å‡πÇ‡∏õ‡πà‡∏á‡∏•‡∏≠‡∏¢ */
/* ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö */
.balloon-item {
  position: absolute;
  z-index: 2000; /* <--- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡πÇ‡∏õ‡πà‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡πÄ‡∏™‡∏°‡∏≠) */
  transition: transform 0.2s;
  animation: floatBalloon 3s ease-in-out infinite alternate;
  cursor: pointer; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏∑‡∏≠‡∏ô‡∏¥‡πâ‡∏ß‡∏ä‡∏µ‡πâ */
}

.balloon-item:hover {
  transform: scale(1.1);
}

@keyframes floatBalloon {
  from { transform: translateY(0); }
  to { transform: translateY(-20px); }
}

/* Animation ‡∏ï‡∏≠‡∏ô‡πÅ‡∏ï‡∏Å */
.pop-effect {
  position: absolute;
  animation: popScale 0.3s ease-out forwards;
}

@keyframes popScale {
  0% { transform: scale(0.5); opacity: 1; }
  100% { transform: scale(1.5); opacity: 0; }
}

/* Animation ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏î‡πâ‡∏á */
.animate-pulse {
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(255, 64, 129, 0.7); }
  70% { box-shadow: 0 0 0 15px rgba(255, 64, 129, 0); }
  100% { box-shadow: 0 0 0 0 rgba(255, 64, 129, 0); }
}

/* Text Shadow */
.drop-shadow {
  text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
}

.animate-shake {
  animation: shake 2s infinite;
}

@keyframes shake {
  0%, 100% { transform: rotate(0deg); }
  25% { transform: rotate(-10deg); }
  75% { transform: rotate(10deg); }
}
.balloon-wrapper {
  position: absolute;
  /* ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ Animation ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏ß Wrapper ‡πÅ‡∏ó‡∏ô */
  animation: floatBalloon 3s ease-in-out infinite alternate; 
  cursor: pointer;
}

/* ‡∏•‡∏ö animation ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å .balloon-item ‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏¥‡∏° ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô */
.balloon-item {
  /* ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà transition ‡πÑ‡∏ß‡πâ */
  transition: transform 0.1s; 
}

.balloon-item:active {
  transform: scale(0.9); /* ‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏¢‡∏∏‡∏ö‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏Å‡∏î‡πÇ‡∏î‡∏ô */
}
</style>